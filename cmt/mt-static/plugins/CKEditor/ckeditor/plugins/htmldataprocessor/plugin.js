(function(){var a=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,b='{cke_protected}';function c(F){var G=F.children.length,H=F.children[G-1];while(H&&H.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(H.value))H=F.children[--G];return H;};function d(F,G){var H=F.children,I=c(F);if(I){if((G||!CKEDITOR.env.ie)&&I.type==CKEDITOR.NODE_ELEMENT&&I.name=='br')H.pop();if(I.type==CKEDITOR.NODE_TEXT&&a.test(I.value))H.pop();}};function e(F){var G=c(F);return!G||G.type==CKEDITOR.NODE_ELEMENT&&G.name=='br'||F.name=='form'&&G.name=='input';};function f(F){d(F,true);if(e(F))if(CKEDITOR.env.ie)F.add(new CKEDITOR.htmlParser.text('\xa0'));else F.add(new CKEDITOR.htmlParser.element('br',{}));};function g(F){d(F);if(e(F))F.add(new CKEDITOR.htmlParser.text('\xa0'));};var h=CKEDITOR.dtd,i=CKEDITOR.tools.extend({},h.$block,h.$listItem,h.$tableContent);for(var j in i){if(!('br' in h[j]))delete i[j];}delete i.pre;var k={elements:{},attributeNames:[[/^on/,'_cke_pa_on']]},l={elements:{}};for(j in i)l.elements[j]=f;var m={elementNames:[[/^cke:/,''],[/^\?xml:namespace$/,'']],attributeNames:[[/^_cke_(saved|pa)_/,''],[/^_cke.*/,''],['hidefocus','']],elements:{$:function(F){var G=F.attributes;if(G){if(G.cke_temp)return false;var H=['name','href','src'],I;for(var J=0;J<H.length;J++){I='_cke_saved_'+H[J];I in G&&delete G[H[J]];}}return F;},embed:function(F){var G=F.parent;if(G&&G.name=='object'){var H=G.attributes.width,I=G.attributes.height;H&&(F.attributes.width=H);I&&(F.attributes.height=I);}},param:function(F){F.children=[];F.isEmpty=true;return F;},a:function(F){if(!(F.children.length||F.attributes.name||F.attributes._cke_saved_name))return false;},html:function(F){delete F.attributes.contenteditable;delete F.attributes['class'];},body:function(F){delete F.attributes.spellcheck;delete F.attributes.contenteditable;},style:function(F){var G=F.children[0];G&&G.value&&(G.value=CKEDITOR.tools.trim(G.value));if(!F.attributes.type)F.attributes.type='text/css';},title:function(F){F.children[0].value=F.attributes._cke_title;}},attributes:{'class':function(F,G){return CKEDITOR.tools.ltrim(F.replace(/(?:^|\s+)cke_[^\s]*/g,''))||false;}},comment:function(F){if(F.substr(0,b.length)==b){if(F.substr(b.length,3)=='{C}')F=F.substr(b.length+3);else F=F.substr(b.length);return new CKEDITOR.htmlParser.cdata(decodeURIComponent(F));}return F;}},n={elements:{}};for(j in i)n.elements[j]=g;if(CKEDITOR.env.ie)m.attributes.style=function(F,G){return F.toLowerCase();};function o(F){F.attributes.contenteditable='false';};function p(F){delete F.attributes.contenteditable;
};for(j in {input:1,textarea:1}){k.elements[j]=o;m.elements[j]=p;}var q=/<(?:a|area|img|input)[\s\S]*?\s((?:href|src|name)\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|(?:[^ "'>]+)))/gi,r=/(?:<style(?=[ >])[^>]*>[\s\S]*<\/style>)|(?:<(:?link|meta|base)[^>]*>)/gi,s=/<cke:encoded>([^<]*)<\/cke:encoded>/gi,t=/(<\/?)((?:object|embed|param|html|body|head|title)[^>]*>)/gi,u=/(<\/?)cke:((?:html|body|head|title)[^>]*>)/gi,v=/<cke:(param|embed)([^>]*?)\/?>(?!\s*<\/cke:\1)/gi;function w(F){return F.replace(q,'$& _cke_saved_$1');};function x(F){return F.replace(r,function(G){return '<cke:encoded>'+encodeURIComponent(G)+'</cke:encoded>';});};function y(F){return F.replace(s,function(G,H){return decodeURIComponent(H);});};function z(F){return F.replace(t,'$1cke:$2');};function A(F){return F.replace(u,'$1$2');};function B(F){return F.replace(v,'<cke:$1$2></cke:$1>');};function C(F){return F.replace(/<!--(?!{cke_protected})[\s\S]+?-->/g,function(G){return '<!--'+b+'{C}'+encodeURIComponent(G).replace(/--/g,'%2D%2D')+'-->';});};function D(F){return F.replace(/<!--\{cke_protected\}\{C\}([\s\S]+?)-->/g,function(G,H){return decodeURIComponent(H);});};function E(F,G){var H=[],I=/<\!--\{cke_temp(comment)?\}(\d*?)-->/g,J=[/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi].concat(G);F=F.replace(/<!--[\s\S]*?-->/g,function(L){return '<!--{cke_tempcomment}'+(H.push(L)-1)+'-->';});for(var K=0;K<J.length;K++)F=F.replace(J[K],function(L){L=L.replace(I,function(M,N,O){return H[O];});return '<!--{cke_temp}'+(H.push(L)-1)+'-->';});F=F.replace(I,function(L,M,N){return '<!--'+b+(M?'{C}':'')+encodeURIComponent(H[N]).replace(/--/g,'%2D%2D')+'-->';});return F;};CKEDITOR.plugins.add('htmldataprocessor',{requires:['htmlwriter'],init:function(F){var G=F.dataProcessor=new CKEDITOR.htmlDataProcessor(F);G.writer.forceSimpleAmpersand=F.config.forceSimpleAmpersand;G.dataFilter.addRules(k);G.dataFilter.addRules(l);G.htmlFilter.addRules(m);G.htmlFilter.addRules(n);}});CKEDITOR.htmlDataProcessor=function(F){var G=this;G.editor=F;G.writer=new CKEDITOR.htmlWriter();G.dataFilter=new CKEDITOR.htmlParser.filter();G.htmlFilter=new CKEDITOR.htmlParser.filter();};CKEDITOR.htmlDataProcessor.prototype={toHtml:function(F,G){F=E(F,this.editor.config.protectedSource);F=w(F);F=x(F);F=z(F);F=B(F);var H=new CKEDITOR.dom.element('div');H.setHtml('a'+F);F=H.getHtml().substr(1);F=A(F);F=y(F);F=D(F);var I=CKEDITOR.htmlParser.fragment.fromHtml(F,G),J=new CKEDITOR.htmlParser.basicWriter();I.writeHtml(J,this.dataFilter);F=J.getHtml(true);
F=C(F);return F;},toDataFormat:function(F,G){var H=this.writer,I=CKEDITOR.htmlParser.fragment.fromHtml(F,G);H.reset();I.writeHtml(H,this.htmlFilter);return H.getHtml(true);}};})();CKEDITOR.config.forceSimpleAmpersand=false;
