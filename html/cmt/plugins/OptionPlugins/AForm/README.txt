=====================================================================
A-Form 2.0.2 for MT/MTOS 5.x
  - A plugin add "A-Form" functionality to MT 5.x. -
                                                  Released 2010-06-09
=====================================================================


はじめに
=====================================================================
A-Formプラグインをダウンロードいただきありがとうございます。

このドキュメントにはA-Formプラグインの説明とインストール手順、
セットアップ手順をまとめています。A-Formプラグインのご利用に
あたってはこのドキュメントをお読みになり、手順に従ってご利用
いただきますようお願い申し上げます。


このプラグインについて
=====================================================================
本プラグインはMovable Type/MTOS 5.x(以下：MT 5.x)用プラグインです。

※ リリース時点の対応バージョンはMT 5.02です。
※ MT5対応版です。MT4.x 以下のバージョンとの組み合わせでは動作しません。
　 MT4.xと共にお使いの場合は A-Form Bamboo 1.3.x をご利用ください。

本プラグインはMT5.xに主に以下の機能を提供します。
 
 - MTの管理画面上からの簡単なメールフォーム作成
 - ドラッグ＆ドロップなどAjaxを利用した直感的UIによるフィールド編集
 - 任意のウェブページ/エントリーへのフォームの埋め込み
 - 複数ページへの同一フォームの埋め込み
 - Ajaxを利用した非同期のフォームの入力エラーチェック
 - ユーザと管理者双方への受付データのメール送信
 - 受付データのCSVダウンロード
 - フォームのコンバージョン情報レポート
 - フォームの動作確認レポート
 - etc..




詳しくは以下のリソースをご参照ください。

  - ARK-Web Movable Type 
    http://www.ark-web.jp/movabletype/

また、フォームのデモ環境もご用意しております。

  - A-Form フォームデモ
    http://movabletype.ark-web.jp/demo/


インストール方法
======================================================================
1. ダウンロードファイルを解凍してください。解凍すると以下のディレクトリ、
   ファイルが展開されます。

     README.txt               <- このファイルです。
     mt-static/plugins/AForm/ <- 以下、解凍ファイルの[mt-static]ディレクトリと呼称します。
     plugins/AForm/           <- 以下、解凍ファイルの[pluings]ディレクトリと呼称します。

2. Movable Typeをインストールしたディレクトリの
  ・[plugins]ディレクトリに、解凍ファイルの[plugins]ディレクトリ以下をまるごとアップロードしてください。
  ・[mt-static]ディレクトリに、解凍ファイルの[mt-static]ディレクトリ以下をまるごとアップロードしてください。

  ※[mt-static]ディレクトリがブログごとにある場合
    ブログごとに異なる[mt-static]ディレクトリを設けている場合は、
    それぞれの[mt-static]ディレクトリに、
    解凍ファイルの[mt-static]ディレクトリをコピーしてください。

3. 次のファイルのパーミッションを 755 に設定してください。

  [plugins]/AForm/aform_engine.cgi
  [plugins]/AForm/aform_logger.cgi
  [plugins]/AForm/aform_checker.cgi

  ※環境によっては777や775に設定する必要があるかもしれません。

4. Movable Typeの管理画面にアクセスしてください。
   自動的にインストール処理が実行されますので、画面の案内にしたがってインストールしてください。

5. Movable Typeをインストールしたディレクトリのmt-config.cgiに
   次の１行を追加します。

   TimeOffset 9


初期設定（MTタグの編集）
======================================================================
1. MTの管理画面にテンプレート編集可能な権限でログインしてください。

2. テンプレート内の次のタグに「aform="1"」属性を追記してください。

  ・<$MTPageBody$>
  ・<$MTPageMore$>
  ・<$MTEntryBody$>
  ・<$MTEntryMore$>

   例）
      <$MTEntryBody$> → <$MTEntryBody aform="1"$>

  これらのタグはテンプレートセットが「既定のブログ」ではそれぞれ
  次の画面遷移でアクセスされるテンプレートに記述されています。

    <$MTPageBody$>、<$MTPageMore$>:
        対象のブログを選択->
          メニューから[デザイン]を選択->
            クイックフィルタから[テンプレートモジュール]を選択->
              [ウェブページの詳細]を選択

    <$MTEntryBody$>、<$MTEntryMore$>：
        対象のブログを選択->
          メニューから[デザイン]を選択->
            クイックフィルタから[テンプレートモジュール]を選択->
              [ブログ記事の詳細]を選択

  MTの任意のテンプレートをヘッダ、フッタに利用したい場合は以下を
  ご参照ください。
 
    任意のテンプレートをヘッダ、フッタに利用する | 「A-Form」グループ＠Googleグループ 
    http://groups.google.co.jp/group/mt-a-form/web/%E4%BB%BB%E6%84%8F%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E3%83%98%E3%83%83%E3%83%80%E3%80%81%E3%83%95%E3%83%83%E3%82%BF%E3%81%AB%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B 


初期設定（動作確認レポート設定）
======================================================================
※ フォームの安定稼動、および障害発生時にこれをすみやかに検出するために
   以下の設定を行って動作確認レポート機能をご利用されることを強くおすす
   めします。

1. MTの管理画面にシステムメニューにアクセス可能な権限でログインしてください。

2. システムメニューの[プラグイン]にアクセスしてください。

3. インストールしているプラグインの一覧が表示されます。一覧から、
   [A-Form 2.x.x]を選び、[設定]をクリックします。

4. [動作確認レポート設定]の設定を行います。

   4-1. サーバでcronが使えない環境の場合は、[フォームへのアクセスで起動]
        に必ずチェックを入れてください。cronが使える環境に関しては設定方法
        を後述します。

        [起動する間隔(例：30min、24h、3day)]に動作確認プログラムの起動間隔を
        指定します。間隔の指定は分、時、日単位で行うことができます。30分なら
        30min、24時間なら24h、3日なら3dayと指定します。
        起動間隔が未指定の場合は24hを指定したものとして扱います。

        なお、ここで指定した起動間隔は確実に実行される起動間隔の指定にはなら
        ないことにご注意ください。cronで起動間隔を指定する場合とは異なり、
        フォームのアクセスで起動する場合は、起動間隔のチェックもフォームに
        アクセスされたタイミングでなされます。そのため、指定した起動間隔以上
        経過していても、A-Formで作成したフォームのどれかにアクセスがあるまで
        は動作確認プログラムは起動しません。

   4-2. [動作確認レポート送信先]に動作確認レポートを受け取る受信可能な
        メールアドレスを必ず指定してください。

   4-3. [確認画面アクセス数の閾値]に数値を半角で指定してください。
        フォーム単位に確認画面へのアクセス数をチェックし、前回チェック時から
        指定した値より少ない確認画面へのアクセスしかないフォームが
        存在したらフォームが正しく動いていない可能性があると判断して
        確認処理の動作確認レポートメールを送ります。
        未指定の場合は1を指定したものとして扱います。

   4-4. [受付データ保存数の閾値]に数値を半角で指定してください。
        フォーム単位に受付データの保存回数をチェックし、前回チェック時から
        指定した値より少ない回数しか受付データを保存していないフォームが
        存在したらフォームが正しく動いていない可能性があると判断して
        保存処理の動作確認レポートメールを送ります。
        未指定の場合は1を指定したものとして扱います。

5. [変更を保存]ボタンをクリックして、以上の設定を保存します。

6. cronが使える環境を利用している場合は、一定時間単位に動作確認
   プログラム（[plugins]/AForm/aform_checker.cgi）を起動するよう
   にcronを設定します。
   以下は毎日午前0時に動作確認プログラムを起動する設定例です。

   0 0 * * * perl [plugins]/AForm/aform_checker.cgi cron

   ※ [plugins]のパスはインストールした環境に合わせて変更してください。
      たとえば、[plugins]ディレクトリが/var/www/cgi-bin/mt/plugins/の場合は
        0 0 * * * perl /var/www/cgi-bin/mt/plugins/AForm/aform_checker.cgi cron
      と設定します。また、cronで起動するときは最後にパラメータ「cron」を渡します。

   なお、cronを使う場合は4-1の[フォームへのアクセスで起動]のチェックを
   オフにしてください。


フォームの作成方法
======================================================================
※ フォームを作成できるのはシステム権限の[ブログの作成]権限を
   持つユーザです。この権限を持たないユーザはフォームの作成、
   ならびに、編集、削除、複製、受付データのダウンロード、コンバージョン
   率の確認なども行うことができません。

1.  MTの管理画面システム権限の[ブログの作成]権限でログインしてください。

2.  システムメニューの[A-Form]、またはブログメニューの[A-Form]->
    [一覧]を選択します。存在するフォームの一覧が表示されます。
     
3. 「新しいフォームを作成する」をクリックします。

4.  フォーム名を指定するウィンドウが立ち上がりますので、
    フォーム名を入力して[保存]ボタンを押します。

5.  「フォーム編集」画面に移動しますので、フィールドの
    配置や編集を行い保存します。

6. 「詳細設定」画面に移動して「控えメールの管理」の
    [宛先(メールアドレス)]に受信可能なメールアドレスを指定します。
    こちらの作業は必須ではありませんが、フォームの受付データの保存が
    万一失敗したケースに備えるために、指定されることを強く推奨します。

7.  一覧画面に戻って作成したフォームIDをメモしておきます。

8.  一覧画面上で作成したフォームの公開状態を[公開]にします。
    [公開]に切り替えるには、一覧画面上で作成したフォームの
    公開状態が[非公開]というリンクになっているので、これを
    クリックします。


フォームの使い方（記事へ埋め込む方法）
======================================================================
※ 以下の作業はウェブページあるいはブログ記事作成・編集権限のあるユーザ
   なら誰でも行えます。

9.  フォームを設置したいブログ記事、またはウェブページの編集画面を開きます。

10. 「本文」、または「続き」内のフォームを埋め込みたい場所に
   
   <!--aformXXX-->       ※フォーマットが「なし」「改行を変換」の場合

   または

   [[aformXXX]]          ※フォーマットが「リッチテキスト」の場合

   と書きます。

   ※XXXは手順7でメモしたフォームIDを3桁で入力します。  (例 <!--aform001-->)
     フォームIDが4桁以上になる場合はそのまま入力します。(例 <!--aform1020-->)

   ※すべて半角英数で入力してください。

   ※[[aformXXX]]のフォーマットで表記する場合は手順10を飛ばしてもかまいません。
     ただし、[[aformXXX]]のフォーマットを利用する場合は記事一覧画面などに
     [[aformXXX]]がそのまま出力されます。
     これを回避したい場合は以下の作業を行ってください。

           [[aformXXX]]が出力されている画面のテンプレートの
           <$MTPageBody$>、<$MTPageMore$>、<$MTEntryBody$>、<$MTEntryMore$>
           にhide_aform="1"を指定する。

      　   例）
             <$MTEntryBody$> → <$MTEntryBody hide_aform="1"$>

           テンプレートセットが既定のブログでは、
             対象のブログを選択->
               メニューから[デザイン]を選択->
                 クイックフィルタから[テンプレートモジュール]を選択->
                   [ブログ記事の概要]を選択
           して表示される<$MTEntryBody$>タグを<$MTEntryBody hide_aform="1"$>に
           変更するだけですが、独自のカスタマイズにより、
           <$MTPageBody$>、<$MTPageMore$>、<$MTEntryBody$>、<$MTEntryMore$>
           が他のテンプレートにも存在する場合は個別にhide_aform="1"を指定します。


より詳細な情報は以下をご参照ください。

  A-Form ドキュメントTOP | 「A-Form」グループ＠Googleグループ
  http://groups.google.co.jp/group/mt-a-form/web/a-form-top

また、作成手順を示した動画もご参照いただけます。ご利用ください。

  「3分でわかる！A-Form」ムービー
  http://www.ark-web.jp/movabletype/a-form/a-form_movie.html



動作環境（インストール環境）
======================================================================
A-Formプラグインが動作する環境は以下の通りです。

  ・Movable Typeのバージョン
    MT5.x
    ※ リリース時点のLatest versionであるMT5.02で動作確認しています。

  ・サーバーOS
    Linux

    ※Fedora Coreで動作確認しております。

  ・ウェブサーバー
    Apache

    ※SMTP、またはsendmailによってメール送信が可能な
      ウェブサーバーである必要があります。

  ・データベース
   - MySQL 5.0 以降

  ※先述した環境以外にもMovable Typeの動作環境

      必要インストール環境と、ブラウザ動作環境 | Movable Type 5 ドキュメント
      http://www.movabletype.jp/documentation/mt5/installation/system.html

    に準拠した環境であれば動作すると思いますが、確認済みの動作環境は
    先述した環境のみになります。


動作環境（文字コード）
======================================================================
A-Formプラグインは文字コードがUTF-8の環境でのみ正常動作します。
PublishCharsetで文字コードをUTF-8から変更されている場合は、
文字コードをUTF-8に戻してお使いください。


動作環境（言語）
======================================================================
A-FormプラグインはMTの日本語版(jaパッケージ)で動作します。
多言語対応は将来のリリースで対応予定です。


推奨利用環境
======================================================================
  ・Windows XP/Vista
   - FireFox 3.0 以降
   - Internet Explorer 7.0 以降
   - Opera 9.26 以降
   - Sleipnir 2.6.2 以降

  ・Mac OS X
   - Safari 3 以降

  ※Movable Typeの管理画面側の機能を利用する際にはブラウザのJavaScriptを
    必ずオンにしてください。


ライセンス
======================================================================
本プラグインは商用/GPL verson2のデュアルライセンスでご提供しています。
MT本体のライセンスにより適用されるライセンス種別が異なります。

1) MTOS（Movable Type Open Source）と組み合わせてご利用の場合

MTOS 5.xと組み合わせてご利用の場合、以下のGPL Version2が適用されます。
GPLにつきましては以下をご参照ください。

  GNU 一般公衆利用許諾契約書
  http://www.opensource.jp/gpl/gpl.ja.html


2) Movable Type（商用版）と組み合わせてご利用の場合

MT 5.xと組み合わせてご利用の場合、以下の商用ライセンスが適用されます。
ここで言うMT 5.xとは、Movable Type 基本ライセンス（有償）および
日本国内向け 個人ライセンス (無償) の両方を含みます。

  A-Form 商用ライセンス利用許諾契約書
  http://www.ark-web.jp/movabletype/a-form/license.txt


有償サポート
======================================================================
有償サポートメニューをご用意しております。

  A-Form導入支援・カスタマイズ
  http://www.ark-web.jp/movabletype/a-form/support.html


「A-Form」グループ＠Googleグループ
======================================================================
Googleグループに「A-Form」グループをご用意しております。

  「A-Form」グループ＠Googleグループ
  http://groups.google.co.jp/group/mt-a-form


技術的な事柄や使い方についての相談や他のユーザとの情報交換などにご利用
ください。また、アップグレード情報、セキュリティ脆弱性や重大な不具合など
のアナウンスもこちらでおこないますので、グループへのご参加を推奨します。


問い合わせ先
======================================================================
ライセンスやお支払いに関すること、カスタマイズ業務のご依頼などは以下の
アドレスまでお問い合わせいただくか、お問い合わせフォームをご利用ください。

  株式会社アークウェブ 問い合わせ先
  info@ark-web.jp

  株式会社アークウェブ お問い合わせフォーム
  https://www.ark-web.jp/contact/index.html

A-Formの技術的な事柄や使い方についてのご相談は
「A-Form」グループ＠Googleグループをご利用ください。

なお、別途、有償サポートメニューもご用意しております。

  A-Form導入支援・カスタマイズ
  http://www.ark-web.jp/movabletype/a-form/support.html


開発者
======================================================================
アークウェブ A-Form 開発チーム


著作権について
======================================================================
著作権は株式会社アークウェブが保有します。
